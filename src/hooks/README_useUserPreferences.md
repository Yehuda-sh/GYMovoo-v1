# useUserPreferences Hook - Enhanced Smart Version ğŸ§ 

## ×ª×™××•×¨ / Description

Hook ×—×›× ×œ×’×™×©×” × ×•×—×” ×œ× ×ª×•× ×™ ×”×¢×“×¤×•×ª ×”××©×ª××© ×¢× ××œ×’×•×¨×™×ª××™× ××ª×§×“××™× ×•× ×™×ª×•×— ××™×©×™×•×ª.
Smart hook for convenient access to user preferences with advanced algorithms and personality analysis.

## ××” ×—×“×©? / What's New?

### ğŸ¯ ××œ×’×•×¨×™×ª× × ×™×ª×•×— ××™×©×™×•×ª

**4 ×¤×¨×•×¤×™×œ×™ ××©×ª××© ×—×›××™×:**

- **××ª×—×™×œ ×–×”×™×¨** - ××©×ª××© ×—×“×© ×©×¦×¨×™×š ×”×“×¨×›×” ×¢×“×™× ×”
- **× ×—×•×© ×œ×”×¦×œ×™×—** - ××•×˜×™×‘×¦×™×” ×’×‘×•×”×” ×•×¢×§×‘×™×•×ª ×˜×•×‘×”
- **×¡×¤×•×¨×˜××™ ×× ×•×¡×”** - ×¨××” ××ª×§×“××ª ×•××•×˜×™×‘×¦×™×” ×’×‘×•×”×”
- **××—×¤×© ××™×–×•×Ÿ** - ××ª××§×“ ×‘×‘×¨×™××•×ª ×•××™×–×•×Ÿ ×—×™×™×

### ğŸ§® ××¢×¨×›×ª × ×™×§×•×“ ×—×›××” (1-10)

```typescript
interface SmartScores {
  motivationLevel: number; // ×¨××ª ××•×˜×™×‘×¦×™×”
  consistencyScore: number; // ×¦×™×•×Ÿ ×¢×§×‘×™×•×ª
  equipmentReadiness: number; // ××•×›× ×•×ª ×¦×™×•×“
  completionQuality: number; // ××™×›×•×ª ×”×©×œ××ª ×”×©××œ×•×Ÿ
}
```

### ğŸ¤– ×”××œ×¦×•×ª ××•×˜×•××˜×™×•×ª

- **×–××Ÿ ××™××•×Ÿ ××™×“×™××œ×™**: ×‘×•×§×¨/×¦×”×¨×™×™×/×¢×¨×‘
- **×§×¦×‘ ×”×ª×§×“××•×ª**: ××™×˜×™/×‘×™× ×•× ×™/××”×™×¨
- **×ª×—×•××™ ×”×ª××§×“×•×ª**: ×§×¨×“×™×•, ×›×•×—, ×˜×›× ×™×§×”, ×‘×˜×™×—×•×ª
- **××–×”×¨×•×ª**: ××•×˜×™×‘×¦×™×” × ××•×›×”, ×¦×™×•×“ ××•×’×‘×œ, ××¦×‘ ×‘×¨×™××•×ª×™

### ğŸ” ×ª×•×‘× ×•×ª ××•×ª×××•×ª ××™×©×™×ª

```typescript
// ×“×•×’×××•×ª ×œ×ª×•×‘× ×•×ª ×©×”××œ×’×•×¨×™×ª× ××¤×™×§:
"ğŸ”¥ ×¨××ª ××•×˜×™×‘×¦×™×” ×’×‘×•×”×” - ××•×›×Ÿ ×œ××ª×’×¨×™×!";
"âš¡ ×¢×§×‘×™×•×ª ××¦×•×™× ×ª - ×–×” ×”××¤×ª×— ×œ×”×¦×œ×—×”";
"ğŸ‹ï¸ ×¦×™×•×“ ××¢×•×œ×” - ×™×© ×œ×š ×›×œ ××” ×©×¦×¨×™×š";
"âš ï¸ ×©×™× ×œ×‘: ××•×˜×™×‘×¦×™×” × ××•×›×”, ×¦×™×•×“ ××•×’×‘×œ";
"ğŸ¯ ××ª××™× ×œ×š: × ×—×•×© ×œ×”×¦×œ×™×—";
```

## ×©×™×¤×•×¨×™× ×˜×›× ×™×™× / Technical Improvements

### ğŸ”„ ×ª××™×›×” ×‘××¢×¨×›×•×ª ××¨×•×‘×•×ª

- **Legacy System**: ××¢×¨×›×ª ×™×©× ×”
- **New System**: ××¢×¨×›×ª ×—×“×©×” ×—×›××”
- **Extended System**: ××¢×¨×›×ª ××•×¨×—×‘×ª
- **Mixed**: ×©×™×œ×•×‘ ××¢×¨×›×•×ª

### ğŸ“Š × ×™×ª×•×— ××™×›×•×ª × ×ª×•× ×™×

```typescript
const calculateDataQuality = (data: QuestionnaireMetadata): number => {
  // ××—×©×‘ ×¦×™×•×Ÿ ××™×›×•×ª × ×ª×•× ×™× (1-10)
  // ××‘×•×¡×¡ ×¢×œ ×©×œ××•×ª ×”××™×“×¢ ×©×¡×•×¤×§ ×¢×œ ×™×“×™ ×”××©×ª××©
};
```

### ğŸ¯ ×ª×•×›× ×™×ª ××™××•×Ÿ ×—×›××”

```typescript
interface SmartWorkoutPlan {
  weeklySchedule: WorkoutRecommendation[];
  personalityMatch: string;
  focusAreas: string[];
  progressionPace: string;
  motivationalBoost: string;
}
```

## ×“×•×’××ª ×©×™××•×© / Usage Example

```typescript
// âœ… Correct import path (updated)
import { useUserPreferences } from './useUserPreferences';

function MyComponent() {
  const {
    preferences,               // ××•×‘×™×™×§×˜ ×××•×—×“ (legacy + new) / unified preferences object
    isLoading,                 // ××¦×‘ ×˜×¢×™× ×”
    systemType,                // 'legacy' | 'new' | 'extended' | 'mixed'
    completionQuality,         // 1-10 ××™×›×•×ª × ×ª×•× ×™×
    personalizedInsights,      // ××¢×¨×š ×ª×•×‘× ×•×ª ×©× ×•×¦×¨ ×‘×§×•××¤×™×œ×¦×™×”
    smartWorkoutPlan,          // ×ª×•×›× ×™×ª ×—×›××” (SmartWorkoutPlan)

    // ×¤×•× ×§×¦×™×•×ª ×—×›××•×ª / Smart helpers
    getSmartInsights,          // () => string[]
    calculateUserScore,        // () => number (1-10 aggregate)
    shouldRecommendUpgrade,    // () => boolean

    // ×¤×¢×•×œ×•×ª / Actions
    refreshPreferences,        // force reload
    clearPreferences           // reset internal cached state
  } = useUserPreferences();

  if (isLoading) return <div>×˜×•×¢×Ÿ × ×ª×•× ×™× ×—×›××™×...</div>;

  const userScore = calculateUserScore();      // 1-10
  const insights = getSmartInsights();         // string[]
  const needsUpgrade = shouldRecommendUpgrade();

  return (
    <div>
      <h2>×¤×¨×•×¤×™×œ: {preferences?.personalityProfile}</h2>
      <p>×¦×™×•×Ÿ ×›×œ×œ×™: {userScore}/10</p>
      <p>××™×›×•×ª × ×ª×•× ×™×: {completionQuality}/10</p>
      <p>××¢×¨×›×ª: {systemType}</p>

      <div>
        <h3>×ª×•×‘× ×•×ª ××™×©×™×•×ª:</h3>
        {insights.map(insight => <p key={insight}>{insight}</p>)}
      </div>

      {needsUpgrade && (
        <div>ğŸš€ ××•××œ×¥ ×œ×©×“×¨×’ ×œ××¢×¨×›×ª ×”×—×“×©×”!</div>
      )}

      {smartWorkoutPlan && (
        <div>
          <h3>×ª×•×›× ×™×ª ××•×ª×××ª:</h3>
          <p>×”×ª××§×“×•×ª: {smartWorkoutPlan.focusAreas.join(", ")}</p>
          <p>×§×¦×‘: {smartWorkoutPlan.progressionPace}</p>
          <p>{smartWorkoutPlan.motivationalBoost}</p>
        </div>
      )}
    </div>
  );
}
```

## Contract ××”×™×¨ / Quick API Contract

```typescript
interface UseUserPreferencesReturn {
  preferences: any | null; // TODO: replace any with explicit UserPreferences type
  isLoading: boolean;
  systemType: "legacy" | "new" | "extended" | "mixed";
  completionQuality: number; // 1-10
  personalizedInsights: string[];
  smartWorkoutPlan: SmartWorkoutPlan | null;
  getSmartInsights(): string[];
  calculateUserScore(): number; // 1-10 aggregate (motivation + consistency + quality)
  shouldRecommendUpgrade(): boolean; // Suggest migration to new system
  refreshPreferences(): Promise<void> | void;
  clearPreferences(): void;
}
```

××§×•×¨×•×ª ×¢×™×§×¨×™×™× / Primary Data Sources:

- legacy: user.questionnaire
- current: user.questionnaireData.answers
- smart: user.smartQuestionnaireData.answers
- extended: user.trainingStats

×œ×•×’×™×§×ª ×—×™×©×•×‘ ××¤×•×¦×œ×ª ×œ-helpers: `userPreferencesHelpers.ts` (scoreFrequency, calculateDataQuality, generateFocusAreas, generateWarningFlags, createSmartWorkoutPlan)

## Hook ××©×œ×™× ×—×›× / Enhanced Quick Workout Hook

```typescript
const {
  workout,
  isLoading,
  error,
  refresh,
  smartInsights, // ğŸ†• ×ª×•×‘× ×•×ª ×œ××™××•×Ÿ ×”××”×™×¨
} = useQuickWorkout();

// smartInsights ××›×™×œ:
// "âš¡ ××™××•×Ÿ ××”×™×¨ ××•×ª×× ×œ×š"
// "ğŸ¯ ×‘×”×ª×‘×¡×¡ ×¢×œ ×”×¢×“×¤×•×ª×™×š ×”××™×©×™×•×ª"
// "ğŸ’ª ××•×›×Ÿ ×œ×”×ª×—×™×œ ×‘×›×œ ×¨×’×¢"
```

## ×™×ª×¨×•× ×•×ª ×”××¢×¨×›×ª ×”×—×›××” / Smart System Benefits

### ğŸ¯ ×”×ª×××” ××™×©×™×ª ××“×•×™×§×ª

- × ×™×ª×•×— ×¤×¨×•×¤×™×œ ××™×©×™×•×ª ××‘×•×¡×¡ × ×ª×•× ×™×
- ×”××œ×¦×•×ª ××•×ª×××•×ª ×œ×¨××ª ×”××©×ª××©
- ×–×™×”×•×™ ×—×•×–×§ ×•×—×•×œ×©×•×ª ××™×©×™×™×

### ğŸ§  ×œ××™×“×” ×—×›××”

- ×”××œ×’×•×¨×™×ª× ×œ×•××“ ××”× ×ª×•× ×™× ×”×§×™×™××™×
- ×©×™×¤×•×¨ ×”××œ×¦×•×ª ×œ××•×¨×š ×–××Ÿ
- ×–×™×”×•×™ ×“×¤×•×¡×™ ×”×ª× ×”×’×•×ª

### ğŸ›¡ï¸ ×‘×˜×™×—×•×ª ×•×× ×™×¢×”

- ×–×™×”×•×™ ××¦×‘×™ ×‘×¨×™××•×ª ××™×•×—×“×™×
- ×”×ª×××ª ×¢×•××¡ ×”××™××•×Ÿ ×œ×¨××ª ×”××©×ª××©
- ××–×”×¨×•×ª ×¢×œ ×‘×¢×™×•×ª ×¤×•×˜× ×¦×™××œ×™×•×ª

### ğŸš€ ××•×˜×™×‘×¦×™×” ××•×ª×××ª

- ×”×•×“×¢×•×ª ××¢×•×“×“×•×ª ××•×ª×××•×ª ××™×©×™×ª
- ×”×›×¨×” ×‘×”×™×©×’×™× ×•×”×ª×§×“××•×ª
- ×¢×–×¨×” ×‘×©××™×¨×” ×¢×œ ××•×˜×™×‘×¦×™×” ×’×‘×•×”×”

---

## ×”×©×•×•××” ×œ×’×¨×¡×” ×”×™×©× ×” / Comparison to Old Version

| ×ª×›×•× ×”         | ×’×¨×¡×” ×™×©× ×” | ×’×¨×¡×” ×—×›××”       |
| ------------- | --------- | --------------- |
| × ×™×ª×•×— ××™×©×™×•×ª  | âŒ        | âœ… 4 ×¤×¨×•×¤×™×œ×™×   |
| ×¦×™×•×Ÿ ×—×›×      | âŒ        | âœ… 4 ××“×“×™×      |
| ×ª×•×‘× ×•×ª ××™×©×™×•×ª | âŒ        | âœ… ×“×™× ××™×•×ª      |
| ×”××œ×¦×•×ª ×–××Ÿ    | âŒ        | âœ… ××•×˜×•××˜×™×•×ª    |
| ×–×™×”×•×™ ×‘×¢×™×•×ª   | âŒ        | âœ… ××–×”×¨×•×ª ×—×›××•×ª |
| ×ª×•×›× ×™×ª ××•×ª×××ª | âŒ        | âœ… ××œ××”         |
| ×ª××™×›×” ××¢×¨×›×•×ª  | âŒ        | âœ… ××¨×•×‘×•×ª       |
| ××™×›×•×ª × ×ª×•× ×™×  | âŒ        | âœ… × ×™×ª×•×—        |

**×¢×›×©×™×• ×”××¢×¨×›×ª ×œ× ×¨×§ ×–×•×›×¨×ª ××” ××ª×” ×¨×•×¦×” - ×”×™× ×™×•×“×¢×ª ××™ ××ª×” ×•××” ××ª××™× ×œ×š!** ğŸ¯ğŸ§ ğŸ’ª

---

## ×¢×“×›×•× ×™× ××—×¨×•× ×™× / Recent Alignment Notes

- ×¢×•×“×›× ×” × ×ª×™×‘ ×”-import (×”×•×¡×¨ ×”×¡×™×•××ª \_NEW).
- ××•××œ×¥ ×œ×”×—×œ×™×£ ×‘×¢×ª×™×“ ××ª `preferences: any` ×‘×˜×™×¤×•×¡ ××¤×•×¨×© (UserPreferencesUnified).
- ×œ×”×•×¡×™×£ ×‘×“×™×§×•×ª ×™×—×™×“×” ×œ-helpers ×”×§×¨×™×˜×™×™× (scoreFrequency, calculateDataQuality).
- ××¤×©×¨×•×ª ×¢×ª×™×“×™×ª: caching in-memory ×œ×¤×™ userId ×œ×× ×™×¢×ª ×¢×•××¡ ×—×™×©×•×‘ ×—×•×–×¨.

## ×©×™×¤×•×¨×™ ×ª×¢×•×“ ××•×¦×¢×™× / Suggested Doc Improvements

1. ×œ×”×•×¡×™×£ ×ª×¨×©×™× ×–×¨×™××” (Flow) ×§×¦×¨ ×œ××™×š × ×‘×—×¨ systemType.
2. ×˜×‘×œ×ª ××©×§×•×œ×•×ª (Weights) ×©×œ ×ª×¨×•××ª ×›×œ ××“×“ ×œ×¦×™×•×Ÿ ×”×›×œ×œ×™.
3. ×“×•×’××ª ×‘×“×™×§×” (jest) ×”××•×•×“××ª personalityProfile ×¦×¤×•×™ ×¢×‘×•×¨ ×¡×˜ ×ª×©×•×‘×•×ª.
4. ×”×•×¡×¤×ª ENV toggle ×œ-DEBUG_PREFS ×œ×”×“×¤×¡×ª ××‘×—×•×Ÿ.
5. ×¨×©×™××ª Edge Cases (×œ×œ× ×¦×™×•×“, ×ª×©×•×‘×•×ª ×—×œ×§×™×•×ª, ××©×ª××© ×—×“×© ×œ×’××¨×™).

×× ×ª×¨×¦×” ×©××××© ×¡×¢×™×¤×™× ××¡×•×™××™× ×‘×§×•×“ ××• ×‘×ª×¢×•×“ â€“ ×›×ª×•×‘ ××¡×¤×¨×™×.
