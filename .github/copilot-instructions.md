# 🧐 בדיקת דיוק הפניות לרכיבים/פיצ'רים

אם יש הפניה לרכיב/פיצ'ר קיים – בדוק שהשם והמיקום מדויקים, גם אם יש קבצים עם שמות דומים בתיקיות אחרות.
אם יש פער בין התיעוד לקוד (למשל מיקום שגוי או שם שונה) – עצור, עדכן את המשתמש, והצע תיקון.

---

## ⚡ Quick rules (TL;DR)

- שמור תשובות קצרות וא-אישיות; העדף בולטים על פני טקסט חופשי.
- אל תבצע רי-פורמט לקבצים שלמים; בצע שינויים מינימליים ורלוונטיים בלבד.
- אחרי שינוי קוד TypeScript: הרץ בדיקת קומפילציה מקומית (`npx tsc --noEmit`).
- בדוק ותקף מבני נתונים (data contracts) בין מסכים/שירותים לפני ריצה.
- React Native/Expo: אם פורט 8081 תפוס – אשר החלפה לפורט חלופי והמשך.
- Windows/PowerShell: ודא פקודות תואמות pwsh.

# 🛑 טיפול בפיצ'רים/רכיבים לא קיימים

אם אתה מזהה במסמך או בקוד הפניה לרכיב/פיצ'ר שלא קיים במימוש:

- עצור ושאל את המשתמש האם להוסיף/לממש, להסיר/לעדכן, או להשאיר כהערה למשימה עתידית.
- אל תבצע שינוי משמעותי בלי אישור מפורש מהמשתמש.

# .github/copilot-instructions.md

## 🏗️ מבנה וארכיטקטורה עיקרית

- הפרויקט בנוי סביב React Native (TypeScript) עם Zustand לניהול state.
- כל מסך/מודול מרכזי נמצא תחת `src/screens/`, רכיבים משותפים ב-`src/components/`, נתונים ב-`src/data/`.
- שירותים עיקריים (כמו יצירת משתמש דמו, שאלון חכם) ממוקמים ב-`src/services/`.
- תיעוד, לקחים, חוקים וסיכומים נמצאים ב-`docs/` ובקבצי README/MD שונים.

## 🛠️ דפוסי עבודה קריטיים

- בנייה והרצה: השתמש בפקודות npm (`npm run android`, `npm run ios`, `npm test`).
- בדיקות: קבצי בדיקות ממוקמים ב-`src/screens/*/test*.js` או בתיקיית `scripts/`. כל שינוי לוגי מחייב בדיקת קבצי בדיקה רלוונטיים.
- ניקוי imports: הסר imports לא בשימוש בכל שינוי.
- קבועים: רכז מחרוזות חוזרות/קבועים ב-`src/constants/`.
- צבעים: השתמש ב-`theme.colors` בלבד.
- RTL ונגישות: ודא שימוש ב-`writingDirection: "rtl"` לכל טקסט בעברית, והוסף/שפר accessibility labels.
- שמירה על פאטצ' קטן: אל תגע בקוד לא קשור; הימנע משינויים סגנוניים גורפים.
- **SafeAreaView חובה**: כל מסך חדש או שיש בו בעיות UI חייב להשתמש ב-`SafeAreaView` מ-`react-native-safe-area-context` למניעת חפיפה עם עיגול המצלמה/המשפך ותחומי המכשיר.

## 📐 Data contracts (אימות מבני נתונים)

- ודא אחידות טיפוסים בין מסכים ושירותים (למשל `ProfileScreen` ↔ `WelcomeScreen` ↔ services).
- הימנע ממערכים מקוננים ללא צורך. דוגמה: `equipment` חייב להיות `string[]` ולא `string[][]`.
- שדות שאלון: ודא ש-`questionnaire` (לוגיקה ישנה) ו-`smartQuestionnaireData` (חדשה) מסונכרנים, במיוחד שדות כמו `equipment`, `goals`, `availability`.
- לפני מיזוג: הדפס ללוג ערכים קריטיים לאימות מהיר (equipment, goals, availability, sessionDuration).

## 🧹 שיפורים וייעול

- הסר כפילויות קוד בכל רמה – השתמש בפונקציות עזר/רכיבים משותפים.
- אל תיגע/תמחק תרגומים – שמור על טקסטים ותיעוד בעברית ואנגלית.
- הסר נתוני דמו/placeholder – החלף בלוגיקה דינמית או הסר.
- רכז קבועים – העבר מחרוזות חוזרות לקובץ constants משותף.
- סדר וקריאות – שמור על מבנה עקבי עם שאר הפרויקט.
- **הסרה הדרגתית**: כשמשתמש מבקש להסיר פיצ'רים (כמו בחירה מהירה, כפתורי עזרה) - הסר בשלבים: קומפוננט ← סגנונות ← פונקציות ← תיעוד.

## 🧑‍🔬 הנחיות טיפול בקבצי דמו (Demo)

כל קובץ/פונקציה/מודול שמזהה דמו (Demo, DemoUser, realisticDemo, placeholder, customDemoUser):

- הפרדה ברורה: שמור את כל קוד הדמו במודול/פונקציה נפרדת (למשל `demoUserService.ts`).
- סימון משתמש דמו: ודא שכל אובייקט דמו מכיל שדה `isDemo: true`.
- הצגת תווית: במסכים – הצג תווית "משתמש דמו" (למפתחים בלבד).
- מחיקת דמו אוטומטית: ודא שמשתמש דמו נמחק אוטומטית בסיום סשן/רענון/יציאה.
- עדכון דמו אוטומטי: כל שינוי בשדות המשתמש/שאלון – עדכן גם את פונקציית הדמו.
- בדיקות אוטומטיות: ודא שכל שדה חדש מופיע גם בדמו (הוסף בדיקות).
- הפעלה/כיבוי דמו: אפשר להפעיל/לכבות דמו בקלות (משתנה סביבה/כפתור dev).
- תיעוד ברור: הוסף תיעוד קצר שמסביר מהו דמו, איך מפעילים, ואיך מזהים אותו.

כל שינוי/שדרוג משמעותי – להציע קודם לאישור המשתמש!

טיפ שימושי: כאשר מוסיפים שדות חדשים למשתמש, עדכן גם את שכבת התאימות לשאלון בסיסי (`user.questionnaire`) כדי להבטיח תצוגה נכונה במסכי פרופיל ישנים.

## 📋 ניהול מסמכים

- בדוק מסמכי docs/README/MD נוספים – אם יש כפילויות, מיזג ועדכן רק את המידע הרלוונטי.
- השאר רק לקחים/הנחיות משמעותיות ועדכניות.
- עדכן תיעוד בכל שינוי משמעותי (בעברית ואנגלית).

## 🔍 בדיקת השפעה

- סקור קבצים/מודולים נוספים – דווח אילו קבצים מושפעים ויש לעדכנם.
- סמן קבצים כפולים/ישנים/לא בשימוש – הצע למחוק עם נימוק.
- בדוק אם יש צורך בעדכון טיפוסים, ממשקים, תרגומים או מסמכי תיעוד.
- זהה רכיבים דומים – הצע איחוד קוד במסכים/מודולים אחרים.
- **שגיאות import**: תמיד בדוק exports/imports אחרי מחיקת קבצים - השתמש ב-grep_search לחיפוש הפניות נותרות.

## 📱 בדיקת UI ותאימות למסך

- **בעיות Safe Area**: אם המשתמש מדווח על חפיפה עם עיגול המצלמה/המשפך או ש-UI לא נגיש, הוסף מיידית `SafeAreaView` מ-`react-native-safe-area-context`.
- **ניווט לא עובד**: בדוק שהפונקציות מחוברות נכון לכפתורים (`onPress={handleFunction}`).
- **בעיות RTL**: ודא `writingDirection: "rtl"`, `textAlign: "right"`, `flexDirection: "row-reverse"` לטקסט עברי.
- **כפתורים לא מגיבים**: בדוק שאין שכבות חוסמות (`zIndex`, `elevation`, רכיבים מכסים).

בדיקות מהירות מומלצות לפני ריצה:

- TypeScript: `npx tsc --noEmit`
- חיפוש הפניות שבורות: חפש מחרוזות ייחודיות של קבצים שנמחקו/הועברו.

## 🛡️ בטיחות

- בצע שינויים רק בתחום הברור והבטוח.
- כל שינוי משמעותי/מיזוג/מחיקה – להציג קודם לאישור.
- אל תמחק פונקציונליות עיקרית – רק דמו/placeholder.
- שמור על TypeScript מלא – ודא שאין שגיאות קומפילציה.

## 🤖 הנחיות לעוזר (AI Assistant)

- זהה את מטרת המשתמש במהירות והצע צעדים ישימים.
- שמור תשובות קצרות, ענייניות, וללא סופרלטיבים. הימנע מעיצוב כבד; בולטים כן, טבלאות רק אם צריך.
- בצע שינויים ישירות כשאפשר; אחרי כל שינוי מהותי, הרץ קומפילציה/בדיקה קצרה.
- כשמבנה נתונים לא ברור – בצע הנחה סבירה אחת או שתיים והמשך, וציין אותן בתמציתיות.
- דווח הבדלי מצב בקיצור (מה שונה מאז הצעד האחרון) במקום לחזור על כל התכנית.

## 🧪 בדיקות איכות

- ודא שהקוד מקומפל (TypeScript).
- בדוק ביצועים – האם השינויים משפרים מהירות/זיכרון.
- זהה באגים פוטנציאליים – לולאות אינסופיות, memory leaks וכו'.

## 🗣️ דיאלוג עם המשתמש

- אם לא ברור – שאל את המשתמש לפני מחיקה/שינוי עמוק.
- הצע שדרוגים משמעותיים רק לאחר קבלת אישור.

## 📱 אמולטור ובדיקות מובייל

- **בעיות גלילה באמולטור**: השתמש ב-ScrollView עם `nestedScrollEnabled={true}`, `removeClippedSubviews={false}`, רווחים גדולים (300px+ bottomSpacer).
- **Debug logging**: הוסף console.log למעקב אחר גלילה, contentSize, scroll position באמולטורים.
- **כשל בפתרונות זמניים**: אם פתרונות כמו כפתורי עזרה/בחירה מהירה לא עובדים - הסר אותם והתמקד בפתרון הבסיסי.

### Expo / React Native 0.77

- לוגי JavaScript: בגרסה 0.77 הלוגים יזוזו ל-React Native DevTools. השתמשו בהם כברירת מחדל; אפשר לפתוח מהטרמינל (קיצור j) כאשר זמין.
- קונפליקט פורטים: אם 8081 תפוס – אשר מעבר לפורט חלופי והמשך. ודא שהאפליקציה/אמולטור מאזינים לפורט המעודכן.
- Windows/Pwsh: וודא שהפקודות מתאימות ל-PowerShell (לדוגמה, ציטוטים ו-backticks בדוקומנטים).

## 🔄 בניית מערכות מחדש

- **זיהוי מורכבות יתר**: כאשר יש מרובה קבצים דומים (SmartQuestionnaireScreen, newSmartQuestionnaire, smartQuestionnaireEquipment) - הצע בנייה מחדש במערכת אחודה.
- **Unified Systems**: העדף קובץ אחד עם מנהל מרכזי (UnifiedManager) על פני מספר קבצים קטנים.
- **נקה תוך כדי**: כשבונה מערכת חדשה, הסר את הישנה מיד כדי למנוע קונפליקטים.

## 🧹 ניקוי ו-Cleanup מקיף

- **מחיקת קבצים ישנים**: אחרי החלפת מערכת, בדוק index.ts files להסרת exports מיותרים.
- **Import cleanup**: אחרי מחיקת רכיבים, חפש imports שנותרו עם grep_search ותקן אותם.
- **תיעוד מעודכן**: עדכן README/MD files להסיר הפניות לרכיבים שנמחקו.
- **סדר פעולות**: מחק קבצים ← תקן imports ← עדכן תיעוד ← בדיקת קומפילציה.
